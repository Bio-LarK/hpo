"use strict";angular.module("hpoApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router","config","dotjem.angular.tree","ui.bootstrap","ajoslin.promise-tracker"]).run(["$state","$stateParams","$rootScope","searchService",function(a,b,c,d){c.$state=a,c.$stateParams=b,c.searchService=d}]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/phenotypes"),a.state("phenotype",{url:"/phenotypes/:phenotypeId",controller:"PhenotypeCtrl",templateUrl:"views/phenotype.html"}).state("phenotypes",{url:"/phenotypes",controller:"PhenotypesCtrl",templateUrl:"views/phenotypes.html"})}]),angular.module("hpoApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("hpoApp").controller("PhenotypesCtrl",["$scope","Phenotype","promiseTracker",function(a,b,c){function d(){var b=f(a.page++);a.loadingTracker.addPromise(b)}function e(){var b=f(a.page++);a.loadingTracker.addPromise(b)}function f(c){return b.query({fields:"nid,concept_label",page:c},function(b){a.phenotypes=a.phenotypes||[],a.phenotypes=a.phenotypes.concat(b)})}a.loadMore=e,a.loadingTracker=c(),a.page=0,d(),console.log("phenotypes ctrl")}]),angular.module("hpoApp").factory("Phenotype",["$resource","$q","$http","ENV",function(a,b,c,d){function e(a){return a.concept_parent=_.map(a.concept_parent,function(a){return new g(a)}),a}function f(){var a=this,c=_.map(this.concept_parent,function(a){return a.id||a.nid});if(!c||!c.length)return b.when([]);var d=_.indexBy(c,function(a,b){return"parameters[nid]["+b+"]"});return d.fields=["nid","concept_label","concept_parent"].join(","),g.query(d).$promise.then(function(b){a.concept_parent=b})}console.log("ENV",d);var g=a(d.apiEndpoint+"/entity_node/:nid",{"parameters[type]":"hpo_concept",nid:"@nid"},{get:{method:"GET",transformResponse:c.defaults.transformResponse.concat([e])}});return g.prototype.getParents=f,g}]),angular.module("hpoApp").filter("inSlicesOf",["$rootScope",function(a){console.log("staring in slice of!!");var b=function(b,c){if(c||(c=3),!angular.isArray(b)&&!angular.isString(b))return b;for(var d=[],e=0;e<b.length;e++){var f=parseInt(e/c,10),g=e%c===0;g&&(d[f]=[]),d[f].push(b[e])}a.arraysinSliceOf=a.arraysinSliceOf||[];var h=null;return angular.forEach(a.arraysinSliceOf,function(a){angular.equals(a,d)&&(h=a)}),h?(console.log("no change"),h):(console.log("change"),a.arraysinSliceOf.push(d),d)};return b}]),angular.module("hpoApp").controller("PhenotypeCtrl",["$scope","$stateParams","promiseTracker","Phenotype",function(a,b,c,d){function e(){var c=d.get({nid:b.phenotypeId},function(b){a.phenotype=b}).$promise;a.loadingTracker.addPromise(c)}function f(a){a.isShowingParents=!a.isShowingParents,a.isShowingParents&&a.getParents()}a.loadingTracker=c(),a.toggleParents=f,e()}]),angular.module("hpoApp").factory("Synonym",["$resource","ENV",function(a,b){console.log("ENV",b);var c=a(b.apiEndpoint+"/entity_node/:nid",{"parameters[type]":"hpo_synonym",nid:"@nid"});return c}]),angular.module("hpoApp").factory("searchService",["ENV","$http","$state",function(a,b,c){var d={getResults:function(c){var d=encodeURIComponent(c),e=a.apiEndpoint+"/search_node/retrieve.json?keys="+d+"&simple=1";return b.get(e).then(function(a){return a.data})},changed:function(a){var b={phenotypeId:a.node};c.go("phenotype",b)}};return d}]);